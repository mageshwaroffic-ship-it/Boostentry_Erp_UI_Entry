===== Data Entry Log for 2025-10-23 ===== 
[00:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[00:04] Execution finished. 
 
[00:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[00:19] Execution finished. 
 
[00:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[00:34] Execution finished. 
 
[00:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[00:49] Execution finished. 
 
[01:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[01:04] Execution finished. 
 
[01:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[01:19] Execution finished. 
 
[01:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[01:34] Execution finished. 
 
[01:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[01:49] Execution finished. 
 
[02:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[02:04] Execution finished. 
 
[02:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[02:19] Execution finished. 
 
[02:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[02:34] Execution finished. 
 
[02:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[02:49] Execution finished. 
 
[03:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[03:04] Execution finished. 
 
[03:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[03:19] Execution finished. 
 
[03:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[03:34] Execution finished. 
 
[03:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[03:49] Execution finished. 
 
[04:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[04:04] Execution finished. 
 
[04:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[04:19] Execution finished. 
 
[04:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[04:34] Execution finished. 
 
[04:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[04:49] Execution finished. 
 
[05:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[05:04] Execution finished. 
 
[05:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[05:19] Execution finished. 
 
[05:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[05:34] Execution finished. 
 
[05:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[05:49] Execution finished. 
 
[06:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[06:04] Execution finished. 
 
[06:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[06:19] Execution finished. 
 
[06:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[06:34] Execution finished. 
 
[06:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[06:49] Execution finished. 
 
[07:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[07:04] Execution finished. 
 
[07:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[07:19] Execution finished. 
 
[07:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[07:34] Execution finished. 
 
[07:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[07:49] Execution finished. 
 
[08:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[08:04] Execution finished. 
 
[08:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[08:19] Execution finished. 
 
[08:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[08:34] Execution finished. 
 
[08:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[08:49] Execution finished. 
 
[09:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[09:04] Execution finished. 
 
[09:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[09:19] Execution finished. 
 
[09:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[09:34] Execution finished. 
 
[09:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[09:49] Execution finished. 
 
[10:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[10:04] Execution finished. 
 
[10:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[10:19] Execution finished. 
 
[10:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[10:34] Execution finished. 
 
[10:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[10:49] Execution finished. 
 
[11:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=7, file=UltraTechCement_Invoice_20251023_051937_945101.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6563
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_10_source_filled.png
âœ… Destination confirmed: MADURAI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY0885
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581886426336
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_17_gsttype_filled.png
âœ… Consignee confirmed: VASU AGENCIES
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_18_consignee_filled.png
âœ… Delivery Address set: AKT MUTHU, 26-B, PLOT 4A JL LIVING, THAIYUR R, EAST JONES ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945101_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=7
âœ… doc_id 7 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 7 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[11:04] Execution finished. 
 
[11:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=8, file=UltraTechCement_Invoice_20251023_051937_939573.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6606
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_10_source_filled.png
âœ… Destination confirmed: SITTALAPAKKAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_11_destination_filled.png
âœ… Vehicle confirmed: TN52U3488
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_12_vehicle_filled.png
âœ… E-Way Bill No filled: 511887001061
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_18_consignee_filled.png
âœ… Delivery Address set: ASTRO HOMES LLP 16/27 09 2025 ASTRO HOMES LLP, FLAT 2 241 PERIYAR SALAL, 62, KARANAI MAIN ROAD, ARAS, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_939573_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 4 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=8
âœ… doc_id 8 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 8 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=9, file=UltraTechCement_Invoice_20251023_051937_944578.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6608
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_08_consignment_no.png
âœ… Date filled: 04.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_10_source_filled.png
âœ… Destination confirmed: MYLAPORE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY0885
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551887001543
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_17_gsttype_filled.png
âœ… Delivery Address set: I 1137475975 VETRISELVI, ED ST JONES ROAD 96, DR, BESANT ROAD, REE OF SUPPLY: CHENN 4, MYLAPORE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.C:\KSS_Working\main.py:233: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%d_%H%M%S")

ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_944578_27_rate_filled.png
âŒ Validation failed â€” missing or unfilled fields: ['Consignee']
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=9
âŒ doc_id 9 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[11:19] Execution finished. 
 
[11:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=14, file=UltraTechCement_Invoice_20251023_051937_941115.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6591
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_10_source_filled.png
âœ… Destination confirmed: AMBATTUR
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_11_destination_filled.png
âœ… Vehicle confirmed: TN19F6397
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_12_vehicle_filled.png
âœ… E-Way Bill No filled: 591886812851
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_17_gsttype_filled.png
âœ… Consignee confirmed: S.V.SERVICES
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_18_consignee_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Delivery Address set: NO, 696, POONAMALLE HIGH ROAD, 200 FEET ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941115_27_rate_filled.png
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=14
âœ… doc_id 14 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 14 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=19, file=UltraTechCement_Invoice_20251023_051937_947783.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 4486
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_08_consignment_no.png
âœ… Date filled: 16.08.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_09_date_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_UltraTechCement_Invoice_20251023_051937_947783_prefilled_CNM_FROM_STN_NAME.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_10_source_filled.png
âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 1): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 2): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 3): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 4): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 5): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_TO_STN_NAME') (attempt 6): Message: 

âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: CHENNAI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_11_destination_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_UltraTechCement_Invoice_20251023_051937_947783_prefilled_CNM_VEHICLENO.png
âœ… Vehicle confirmed: TN73Y7849
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581862204376
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_13_ewaybill_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_UltraTechCement_Invoice_20251023_051937_947783_prefilled_CNM_CNR_NAME.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_17_gsttype_filled.png
âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 1): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 2): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 3): Message: 
C:\KSS_Working\main.py:233: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%d_%H%M%S")

âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 1): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 2): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 3): Message: 

âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_947783_18_consignee_filled.png
âŒ Error in fill_consignment_form main flow: Message: 

ğŸ§¾ Validation built: 7 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=19
âŒ doc_id 19 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=20, file=UltraTechCement_Invoice_20251023_051937_940484.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_10_source_filled.png
âœ… Destination confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_11_destination_filled.png
âœ… Vehicle confirmed: TN73U1383
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581886745765
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_18_consignee_filled.png
âœ… Delivery Address set: 21, 3RD MAIN ROAD, DHANDEESWARAM NAGAR 3RD STREET, VELACHERY CHENNAI, TAMIL NADU SEGMENT
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_940484_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Popup closed with selector: xpath=//button[normalize-space()='OK']
âŒ Validation failed â€” missing or unfilled fields: ['ConsignmentNo']
ğŸ§¾ Validation built: 1 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=20
âŒ doc_id 20 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=15, file=UltraTechCement_Invoice_20251023_051937_948392.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 4132
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_08_consignment_no.png
âœ… Date filled: 07.08.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_09_date_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_UltraTechCement_Invoice_20251023_051937_948392_prefilled_CNM_FROM_STN_NAME.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_10_source_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_UltraTechCement_Invoice_20251023_051937_948392_prefilled_CNM_TO_STN_NAME.png
âœ… Destination confirmed: GANGAVARAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_11_destination_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_UltraTechCement_Invoice_20251023_051937_948392_prefilled_CNM_VEHICLENO.png
âœ… Vehicle confirmed: TN29AV7179
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_12_vehicle_filled.png
âœ… E-Way Bill No filled: 521897647955
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_13_ewaybill_filled.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_UltraTechCement_Invoice_20251023_051937_948392_prefilled_CNM_CNR_NAME.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_17_gsttype_filled.png
âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 1): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 2): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 3): Message: 

âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 1): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 2): Message: 

âš ï¸ safe_click failed for ('id', 'CNM_CNE_NAME') (attempt 3): Message: 

âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_948392_18_consignee_filled.png
âŒ Error in fill_consignment_form main flow: Message: 

ğŸ§¾ Validation built: 6 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=15
âŒ doc_id 15 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=22, file=UltraTechCement_Invoice_20251023_051937_946966.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 5157
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_08_consignment_no.png
âœ… Date filled: 30.08.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_10_source_filled.png
âœ… Destination confirmed: PONNERI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY4009
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581869636048
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_18_consignee_filled.png
âœ… Delivery Address set: KUMAARASAAMI, 60 MURUGAN KOIL STREET EXTN, 197 LAKSHMI AMMAN KOIL STREET, SANTHOSH NAGAR, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946966_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 4 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=22
âœ… doc_id 22 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 22 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=16, file=UltraTechCement_Invoice_20251023_051937_949106.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6000
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_08_consignment_no.png
âœ… Date filled: 20.09.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_10_source_filled.png
âœ… Destination confirmed: POONAMALLEE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_11_destination_filled.png
âœ… Vehicle confirmed: TN23AM5290
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_12_vehicle_filled.png
âœ… E-Way Bill No filled: 561879967200
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_17_gsttype_filled.png
âœ… Consignee confirmed: KEC International Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_18_consignee_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Delivery Address set: HCC - KEC CONSORTIUM CMRL, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_949106_27_rate_filled.png
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=16
âœ… doc_id 16 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 16 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=17, file=UltraTechCement_Invoice_20251023_051937_943358.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6616
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_10_source_filled.png
âœ… Destination confirmed: PALLIPATTU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_11_destination_filled.png
â†» Retry 1/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 6 attempts.
âš ï¸ Vehicle not confirmed: TN73BZ7347
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551886992908
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_18_consignee_filled.png
âœ… Delivery Address set: NO R83/1 TNHB, CHITOOR ROAD, KAKKALUR BYE PASS ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Vehicle
ğŸ” Pass 2: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Vehicle
ğŸ” Pass 3: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Vehicle
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943358_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=17
âœ… doc_id 17 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 17 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=10, file=UltraTechCement_Invoice_20251023_051937_943933.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6590
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_10_source_filled.png
âœ… Destination confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_11_destination_filled.png
âœ… Vehicle confirmed: TN88L6472
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_12_vehicle_filled.png
âœ… E-Way Bill No filled: 501886879581
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_17_gsttype_filled.png
âœ… Consignee confirmed: K R HARDWARE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_18_consignee_filled.png
âœ… Delivery Address set: K R HARDWARE 1137456147/ SRI VENKATESHWARA AGENCY, 6, KUNDRATHUR MAIN ROAD, 64 KAMARAJ MAIN ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_943933_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=10
âœ… doc_id 10 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 10 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=11, file=UltraTechCement_Invoice_20251023_051937_942267.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6585
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: DESTINATION GUMMIDIPOONDI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_11_destination_filled.png
âœ… Vehicle confirmed: TN88L6422
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_12_vehicle_filled.png
âœ… E-Way Bill No filled: 501886761626
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_18_consignee_filled.png
âœ… Delivery Address set: 140 GNT ROAD 140 GNT ROAD, STAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942267_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Popup closed with selector: xpath=//button[normalize-space()='OK']
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 2 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=11
âœ… doc_id 11 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 11 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=13, file=UltraTechCement_Invoice_20251023_051937_941690.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6614
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: THIRUMASHISA
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY4009
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551886954812
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_18_consignee_filled.png
âœ… Delivery Address set: LAKSHMI, 60 MURUGAN KOIL STREET EXTN, 267 VELLAVEDU HIGH ROAD, SANTHOSH NAGAR, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_941690_27_rate_filled.png
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=13
âœ… doc_id 13 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 13 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=12, file=UltraTechCement_Invoice_20251023_051937_945734.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 5247
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_08_consignment_no.png
âœ… Date filled: 01.09.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_10_source_filled.png
âœ… Destination confirmed: CHROMPET
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_11_destination_filled.png
âœ… Vehicle confirmed: TN73U1383
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_12_vehicle_filled.png
âœ… E-Way Bill No filled: 591870391184
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='GIANT CEMENT TRADING PRIVATE LIMITED', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'GIANT CEMENT TRADING PRIVATE L' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_18_consignee_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Delivery Address set: 70, SUSILA BAI COMPLEX, STATION ROAD, RADHA NAGAR TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_945734_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 4 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=12
âœ… doc_id 12 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 12 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=21, file=UltraTechCement_Invoice_20251023_051937_946122.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 5811
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_08_consignment_no.png
âœ… Date filled: 14.09.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_10_source_filled.png
âœ… Destination confirmed: SRIPERUMBUDUR
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_11_destination_filled.png
âœ… Vehicle confirmed: TN45AV2964
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_12_vehicle_filled.png
âœ… E-Way Bill No filled: 521877015989
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_17_gsttype_filled.png
âœ… Consignee confirmed: Oriental Structural Engineers
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_18_consignee_filled.png
âœ… Delivery Address set: NO: 15/3A KAN, KANDAMANGALAM VILLAGE, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_946122_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=21
âœ… doc_id 21 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 21 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=18, file=UltraTechCement_Invoice_20251023_051937_942786.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6612
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: CHENGALPET JESPATCH
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY3733
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_12_vehicle_filled.png
âœ… E-Way Bill No filled: 591886955338
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_18_consignee_filled.png
âœ… Delivery Address set: KAMALAM, WE MURUGAN KOIL STREET EXTN, 12 CHENGALPATTU MAIN ROAD, SANTHOSH NAGAR, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_051937_942786_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=18
âœ… doc_id 18 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 18 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[11:34] Execution finished. 
 
[12:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[12:34] Execution finished. 
 
[12:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[12:49] Execution finished. 
 
[13:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[13:04] Execution finished. 
 
[13:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[13:19] Execution finished. 
 
[13:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[13:34] Execution finished. 
 
[13:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[13:49] Execution finished. 
 
[14:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[14:04] Execution finished. 
 
[14:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[14:19] Execution finished. 
 
[14:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[14:34] Execution finished. 
 
[14:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[14:49] Execution finished. 
 
[15:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[15:04] Execution finished. 
 
[15:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[15:19] Execution finished. 
 
[15:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[15:34] Execution finished. 
 
[15:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[15:49] Execution finished. 
 
[16:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=23, file=UltraTechCement_Invoice_20251023_102404_358698.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6606
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_10_source_filled.png
âœ… Destination confirmed: SITTALAPAKKAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_11_destination_filled.png
âœ… Vehicle confirmed: TN52U3488
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_12_vehicle_filled.png
âœ… E-Way Bill No filled: 511887001061
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_18_consignee_filled.png
âœ… Delivery Address set: ASTRO HOMES LLP 16/27 09 2025 ASTRO HOMES LLP, FLAT 2 241 PERIYAR SALAL, 62, KARANAI MAIN ROAD, ARAS, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_102404_358698_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 4 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=23
âœ… doc_id 23 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 23 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[16:04] Execution finished. 
 
[16:19] Starting main.py 
C:\KSS_Working\main.py:233: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%d_%H%M%S")
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=1, file=UltraTechCement_Invoice_20251023_104420_589805.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_10_source_filled.png
âœ… Destination confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_11_destination_filled.png
âœ… Vehicle confirmed: TN73U1383
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581886745765
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value '#21' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_18_consignee_filled.png
âœ… Delivery Address set: 21, 3RD MAIN ROAD, DHANDEESWARAM NAGAR 3RD STREET, VELACHERY CHENNAI, TAMIL NADU SEGMENT
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_589805_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Popup closed with selector: xpath=//button[normalize-space()='OK']
âŒ Validation failed â€” missing or unfilled fields: ['ConsignmentNo']
ğŸ§¾ Validation built: 1 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=1
âŒ doc_id 1 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=4, file=UltraTechCement_Invoice_20251023_104420_594181.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6563
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_10_source_filled.png
âœ… Destination confirmed: MADURAI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY0885
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_12_vehicle_filled.png
âœ… E-Way Bill No filled: 581886426336
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_17_gsttype_filled.png
âœ… Consignee confirmed: VASU AGENCIES
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_18_consignee_filled.png
âœ… Delivery Address set: AKT MUTHU, 26-B, PLOT 4A JL LIVING, THAIYUR R, EAST JONES ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_594181_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=4
âœ… doc_id 4 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 4 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=8, file=UltraTechCement_Invoice_20251023_104420_593033.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6590
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_10_source_filled.png
âœ… Destination confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_11_destination_filled.png
âœ… Vehicle confirmed: TN88L6472
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_12_vehicle_filled.png
âœ… E-Way Bill No filled: 501886879581
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_17_gsttype_filled.png
âœ… Consignee confirmed: K R HARDWARE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_18_consignee_filled.png
âœ… Delivery Address set: K R HARDWARE 1137456147/ SRI VENKATESHWARA AGENCY, 6, KUNDRATHUR MAIN ROAD, 64 KAMARAJ MAIN ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593033_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=8
âœ… doc_id 8 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 8 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=5, file=UltraTechCement_Invoice_20251023_104420_592468.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6616
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_10_source_filled.png
âœ… Destination confirmed: PALLIPATTU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_11_destination_filled.png
â†» Retry 1/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 6 attempts.
âš ï¸ Vehicle not confirmed: TN73BZ7347
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551886992908
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'K.S. TRADERS' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_18_consignee_filled.png
âœ… Delivery Address set: NO R83/1 TNHB, CHITOOR ROAD, KAKKALUR BYE PASS ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Vehicle
ğŸ” Pass 2: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Vehicle
ğŸ” Pass 3: 'Vehicle' not verified (have='', want [equals] 'TN73BZ7347') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_VEHICLENO') value 'TN73BZ7347' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_VEHICLENO') after 5 attempts.
âŒ 'Vehicle' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Vehicle
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_592468_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=5
âœ… doc_id 5 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 5 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=2, file=UltraTechCement_Invoice_20251023_104420_591418.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6585
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: DESTINATION GUMMIDIPOONDI
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_11_destination_filled.png
âœ… Vehicle confirmed: TN88L6422
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_12_vehicle_filled.png
âœ… E-Way Bill No filled: 501886761626
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'NO.140 GNT ROAD NO.140 GNT ROAD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_18_consignee_filled.png
âœ… Delivery Address set: 140 GNT ROAD 140 GNT ROAD, STAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='', want [equals] 'DESTINATION GUMMIDIPOONDI') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'DESTINATION GUMMIDIPOONDI' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591418_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Popup closed with selector: xpath=//button[normalize-space()='OK']
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 2 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=2
âœ… doc_id 2 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 2 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=3, file=UltraTechCement_Invoice_20251023_104420_593634.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6608
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_08_consignment_no.png
âœ… Date filled: 04.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_10_source_filled.png
âœ… Destination confirmed: MYLAPORE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY0885
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551887001543
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_17_gsttype_filled.png
âœ… Delivery Address set: I 1137475975 VETRISELVI, ED ST JONES ROAD 96, DR, BESANT ROAD, REE OF SUPPLY: CHENN 4, MYLAPORE
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_593634_27_rate_filled.png
âŒ Validation failed â€” missing or unfilled fields: ['Consignee']
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=3
âŒ doc_id 3 marked as Failed due to form fill issues.
â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=7, file=UltraTechCement_Invoice_20251023_104420_590318.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6591
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_10_source_filled.png
âœ… Destination confirmed: AMBATTUR
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_11_destination_filled.png
âœ… Vehicle confirmed: TN19F6397
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_12_vehicle_filled.png
âœ… E-Way Bill No filled: 591886812851
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_17_gsttype_filled.png
âœ… Consignee confirmed: S.V.SERVICES
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_18_consignee_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… Delivery Address set: NO, 696, POONAMALLE HIGH ROAD, 200 FEET ROAD, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590318_27_rate_filled.png
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 3 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=7
âœ… doc_id 7 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 7 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=6, file=UltraTechCement_Invoice_20251023_104420_590857.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6614
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: THIRUMASHISA
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY4009
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_12_vehicle_filled.png
âœ… E-Way Bill No filled: 551886954812
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_18_consignee_filled.png
âœ… Delivery Address set: LAKSHMI, 60 MURUGAN KOIL STREET EXTN, 267 VELLAVEDU HIGH ROAD, SANTHOSH NAGAR, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='THIRUMASHISAI', want [equals] 'THIRUMASHISA') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'THIRUMASHISA' (have='THIRUMASHISAI', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_590857_27_rate_filled.png
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=6
âœ… doc_id 6 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 6 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=10, file=UltraTechCement_Invoice_20251023_104420_591956.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6612
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_10_source_filled.png
â†» Retry 1/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 6/6 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 6 attempts.
âš ï¸ Destination not confirmed: CHENGALPET JESPATCH
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_11_destination_filled.png
âœ… Vehicle confirmed: TN73BY3733
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_12_vehicle_filled.png
âœ… E-Way Bill No filled: 591886955338
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'SLT CEMENT MARKETERS PVT LTD' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_18_consignee_filled.png
âœ… Delivery Address set: KAMALAM, WE MURUGAN KOIL STREET EXTN, 12 CHENGALPATTU MAIN ROAD, SANTHOSH NAGAR, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ” Pass 1: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 1: Destination
ğŸ” Pass 2: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 2: Destination
ğŸ” Pass 3: 'Destination' not verified (have='', want [equals] 'CHENGALPET JESPATCH') â€” fixing...
â†» Retry 1/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 2/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 3/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 4/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
â†» Retry 5/5 for ('id', 'CNM_TO_STN_NAME') value 'CHENGALPET JESPATCH' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_TO_STN_NAME') after 5 attempts.
âŒ 'Destination' still not correct after repair attempt.
â†» Fields still incorrect after pass 3: Destination
âš ï¸ Verification finished with unresolved fields after max passes.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_591956_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 5 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=10
âœ… doc_id 10 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 10 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
ğŸ“— Using extracted_json (status NOT STARTED or other).

â–¶ï¸ Claimed doc_id=9, file=UltraTechCement_Invoice_20251023_104420_588960.pdf
ğŸ“¸ C:\KSS_Working\screenshots\00_login_page.png
ğŸ“¸ C:\KSS_Working\screenshots\01_credentials_typed.png
âœ… Clicked Sign in
âœ… Branch selected: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\02_branch_selected.png
ğŸ“¸ C:\KSS_Working\screenshots\popup_handled_after_submit_attempt_1.png
âœ… Branch Submit clicked (handled popups if any)
ğŸ“¸ C:\KSS_Working\screenshots\03_after_branch_submit.png
â³ Waiting for Operations tile...
âš ï¸ Operations tile not found in time (Message: 
), navigating directly to MENU_URL
ğŸ“¸ C:\KSS_Working\screenshots\04_on_menu_page_attempt_1.png
âœ… On Menu page
ğŸ“¸ C:\KSS_Working\screenshots\05_booking_operation_expanded.png
âœ… Booking Operation expanded
ğŸ“¸ C:\KSS_Working\screenshots\06_consignment_clicked.png
âœ… Consignment clicked
âœ… API clicked; checking for iframe...
ğŸ” Found iframes: 1
ğŸ”„ Switched into iframe
ğŸ“¸ C:\KSS_Working\screenshots\07_consignment_form_ready.png
ğŸ¯ Consignment form is open and ready inside iframe
ğŸ“¸ C:\KSS_Working\screenshots\08_date_field_ready.png
ğŸ“… Date field is also ready
âœ… ConsignmentNo filled: 6606
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_08_consignment_no.png
âœ… Date filled: 03.10.2025
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_09_date_filled.png
âœ… Source confirmed: ARAKKONAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_10_source_filled.png
âœ… Destination confirmed: SITTALAPAKKAM
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_11_destination_filled.png
âœ… Vehicle confirmed: TN52U3488
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_12_vehicle_filled.png
âœ… E-Way Bill No filled: 511887001061
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_13_ewaybill_filled.png
âœ… Consignor confirmed: UltraTech Cement Limited
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_15_consignor_filled.png
âœ… GST Type set: Unregistered
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_17_gsttype_filled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âš ï¸ Consignee empty after initial attempts â€” toggling GST Type once and retrying.
ğŸ” GST toggled from 'Unregistered' to 'Registered' and verified.
ğŸ“¸ C:\KSS_Working\screenshots\gst_toggled.png
â†» Retry 1/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 2/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
â†» Retry 3/3 for ('id', 'CNM_CNE_NAME') value 'ASTRO HOMES LLP' (have='', verify=equals)
âŒ Failed to set ('id', 'CNM_CNE_NAME') after 3 attempts.
âŒ Consignee still not found after GST toggle â€” moving on.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_18_consignee_filled.png
âœ… Delivery Address set: ASTRO HOMES LLP 16/27 09 2025 ASTRO HOMES LLP, FLAT 2 241 PERIYAR SALAL, 62, KARANAI MAIN ROAD, ARAS, TAMIL NADU
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_19_deliveryaddress_filled.png
â„¹ï¸ Skipping Consignee in verify_and_repair_fields because Consignee was already tried in fill flow.
ğŸ‰ All fields verified in pass 1.
âœ… 'Add Item' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_21_additem_clicked.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_22_insertitem_contentname_ok.png
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_22_insertitem_filled.png
âœ… 'Add Invoice' clicked.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_24_addinvoice_clicked.png
âœ… Insert Item modal closed.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_25_insertitem_closed.png
âš ï¸ Rate did not stick after verification.
ğŸ“¸ C:\KSS_Working\screenshots\UltraTechCement_Invoice_20251023_104420_588960_27_rate_filled.png
âœ… Popup closed with selector: id=btn-ok
âœ… All required fields filled successfully â€” returning True.
ğŸ§¾ Validation built: 4 field(s) failed.
ğŸ—ƒï¸ ValidationStatus saved into extracted_json for doc_id=9
âœ… doc_id 9 processed successfully.
âŒ process_row_with_driver exception: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 228, in process_row_with_driver
    update_overall_status(conn, doc_id)
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'update_overall_status' is not defined

âŒ doc_id 9 failed during setup: name 'update_overall_status' is not defined
Traceback (most recent call last):
  File "C:\KSS_Working\main.py", line 301, in main_db_process
    raise Exception(msg)
Exception: name 'update_overall_status' is not defined

â³ Waiting 30s before closing browser...
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[16:19] Execution finished. 
 
[17:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[17:04] Execution finished. 
 
[17:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[17:19] Execution finished. 
 
[17:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[17:34] Execution finished. 
 
[17:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[17:49] Execution finished. 
 
[18:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[18:04] Execution finished. 
 
[18:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[18:19] Execution finished. 
 
[18:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[18:34] Execution finished. 
 
[18:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[18:49] Execution finished. 
 
[19:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[19:04] Execution finished. 
 
[19:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[19:19] Execution finished. 
 
[19:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[19:34] Execution finished. 
 
[19:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[19:49] Execution finished. 
 
[20:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[20:04] Execution finished. 
 
[20:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[20:19] Execution finished. 
 
[20:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[20:34] Execution finished. 
 
[20:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[20:49] Execution finished. 
 
[21:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[21:04] Execution finished. 
 
[21:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[21:19] Execution finished. 
 
[21:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[21:34] Execution finished. 
 
[21:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[21:49] Execution finished. 
 
[22:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[22:04] Execution finished. 
 
[22:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[22:19] Execution finished. 
 
[22:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[22:34] Execution finished. 
 
[22:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[22:49] Execution finished. 
 
[23:04] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[23:04] Execution finished. 
 
[23:19] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[23:19] Execution finished. 
 
[23:34] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[23:34] Execution finished. 
 
[23:49] Starting main.py 
âœ… Connected to Remote PostgreSQL
ğŸš€ Starting DB driven processing loop...
Using JSON column: extracted_json
erp_updated_at: False, erp_note: False
âš ï¸ No pending rows found. Exiting loop.
ğŸ Finished DB loop.
[23:49] Execution finished. 
 
